# Cross Chain Mode

## 数据验证
> 目前典型的跨链技术有三种 1、见证人模式，2、哈希锁定模式，3、侧链模式。

### 见证人模式
最易理解的跨链方案。链B想知道链A上发生的交易，让多个见证人把链A上发生的交易各自独立地转发过来。其实就是我们常听说的Oracle预言机系统，链B以类似多签的形式将多个见证人转发的数据进行记录。这中模式适用智能合约或者多签地址。

### 哈希锁定模式
最早出现在比特币的闪电网络，跨链资产交换支持一定数量的 A 链资产和一定数量的 B 链资产进行原子交换。哈希时间锁定巧妙地采用了哈希锁和时间锁，迫使资产的接收方在超时时间内确定收款并产生一种收款证明给打款人，否则资产会归还给打款人。收款证明能够被付款人用来获取接收人区块链上的等量价值的数量资产或触发其他事件。哈希锁定目前看只适合偏资产或者关键数据的交换。

### 侧链模式
相对于主链而言的，侧链存有主链中的区块数据和账本数据 - 轻节点。侧链实现的基础技术是双向锚定（Two-way Peg），通过双向锚定技术可以将数字资产在主链上进行锁定，使用 SPV 技术对主链交易进行验证，验证通过后将等价的资产在平行链中释放。相反当平行链中相关资产进行锁定时，主链上锚定的等价资产也可以被释放。这种跨链的实现方式简单，相对哈希锁定能够提供更多的跨链交互场景。

## 轻节点
为了在平行链上校验主链交易的正确性，必须将主链区块同步到平行链链上。但是，如果要同步主链全节点区块信息，就需要占用几十甚至上百G的存储空间，这不是合理的处理方式。相对做全节点需要巨大的存储量，轻节点只同步区块头部信息（每个区块头几十字节大小），最终只占用几十M空间，是经济合理的选择。

中本聪在比特币白皮书中提到过 SPV (Simplified Payment Verification) 简单支付验证的概念，通过简单支付验证能够在只存储区块头部信息的条件下对交易进行验证。

![light_node](/zh/light_node.png)

区块链中的每个区块有区块头和区块体组成，区块头包含能够验证区块体完整性、合法性的 Merkel 根。

Merkel 树是一颗平衡二叉树，底部叶子节点存储每笔交易的HASH，然后两两配对计算出新的HASH，重复上述操作直到输出一个结果，既 Merkel 根，并将其存入到区块头。

### 步骤
> 通过简单支付验证「交易1」的具体步骤

- 运行时模块向主链节点查询「交易1」的 Merkel Block 信息；
- 收到 Merkel Block 信息，既认证路径（HASH2, HASH34, HASH1234）；
- 运行时模块根据「交易1」、 Merkel Block 信息计算出 Merkel 根；
- 将计算出的 Merkel 根与区块头的 Merkel 根比对，一致则表明交易1是合法交易；